<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">
    <!--
     Copyright 2007-2009 The Kuali Foundation

     Licensed under the Educational Community License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at

     http://www.opensource.org/licenses/ecl2.php

     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License.
    -->

    <!-- ################################# Course Details Popover ############################## -->

    <!--
      This provides the pop-over panels (not the "dialog" ones) for CRUD actions on Course items.
    -->
    <bean id="PlannedCourse-FormView" parent="MyPlanBaseFormView">
        <property name="theme">
            <bean parent="MyPlanRetrievedTheme"/>
        </property>
        <property name="onLoadScript" value=""/>
        <property name="id" value="PlannedCourse-FormView"/>
        <property name="entryPageId" value="add_remove_course_popover_page"/>
        <property name="formClass" value="org.kuali.student.myplan.plan.form.PlanForm"/>
        <property name="footer.render" value="false"/>
        <property name="header.render" value="false"/>
        <property name="cssClasses">
            <list merge="true">
                <value>myplan-view</value>
            </list>
        </property>
        <property name="style" value="margin:0;"/>
        <property name="items">
            <list>

                <!-- Page displaying all plan action response. This page is returned in response to any action on a plan item. It passes data base to javascript events to the UI-->
                <bean parent="Uif-Page" p:id="plan_item_action_response_page">
                    <property name="validationMessages">
                        <bean parent="Uif-GroupValidationMessages">
                            <property name="displayMessages" value="true"/>
                            <property name="displayFieldLabelWithMessages" value="false"/>
                        </bean>
                    </property>
                    <property name="items">
                        <list>
                            <bean id="request_status_item_key" parent="Uif-DataField" p:propertyName="requestStatus"/>
                            <bean id="json_events_item_key" parent="Uif-DataField"
                                  p:propertyName="javascriptEventsAsJSON"/>
                            <!--  These two can go away once the javascript eventing is totally implemented. -->
                            <!--<bean id="add_plan_item_key" parent="Uif-DataField" p:propertyName="planItemId"/>
                            <bean id="course_id_item_key" parent="Uif-DataField" p:propertyName="courseId"/>-->
                        </list>
                    </property>
                </bean>

                <!-- This page builds the popover with the 3 sliding sections used to view course summary, add to plan and remove from courses list contextually -->
                <bean parent="KSAP-PopoverPage" p:id="add_remove_course_popover_page">
                    <property name="header.render" value="false"/>
                    <property name="items">
                        <list>
                            <bean parent="courseTitleLink"/>
                            <bean id="course_popover_group" parent="KSAP-HorizontalBoxGroup-NoMargin" p:width="300px">
                                <property name="items">
                                    <list>
                                        <!-- Course View and Actions -->
                                        <ref bean="course_details_info"/>
                                        <!-- Add to Plan Form fields -->
                                        <ref bean="add_planned_course_fields"/>
                                        <!-- Delete from courses list confirmation -->
                                        <ref bean="delete_from_list_confirmation"/>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>

                <!--This page is used for the View Course Summary Dialog box -->
                <bean parent="KSAP-PopoverPage" p:id="course_summary_dialog_page" p:headerText="View Course Summary">
                    <property name="items">
                        <list>
                            <bean parent="courseTitleLink"/>
                            <bean parent="course_details_summary_info"/>
                        </list>
                    </property>
                </bean>

                <!--This page is used for the Move to another quarter Dialog box -->
                <bean parent="KSAP-PopoverPage" p:id="add_dialog_page" p:headerText="Add to Plan">
                    <property name="instructionalText"
                              value="Which quarter would you like to add [b]@{courseSummaryDetails.code}[/b] to?"/>
                    <property name="items">
                        <list>
                            <ref bean="courseTermsScheduled"/>
                            <ref bean="courseTermSelection"/>
                            <ref bean="courseMarkAsBackup"/>
                            <bean parent="KSAP-HorizontalBoxGroup" p:id="actionButtonsGroup">
                                <property name="items">
                                    <list>
                                        <bean p:id="addPlannedCourse" parent="Uif-PrimaryActionButton-Small"
                                              p:actionLabel="Add To Plan">
                                            <property name="actionScript"
                                                      value="myplanAjaxSubmitPlanItem('@{courseSummaryDetails.courseId}', 'courseId', 'addPlannedCourse', e,true);"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#addPlannedCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                                    if (data.planItemType === 'planned' || data.planItemType === 'backup') {
                                                        fnDisplayMessage(data.message, data.cssClass, 'actionButtonsGroup', true, false);
                                                    }
                                                }).on('ERROR', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true,'errorPlaceholder');
                                                });
                                            "/>
                                        </bean>
                                        <bean parent="closePopoverCancel"/>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="errorPlaceholder"/>
                        </list>
                    </property>
                </bean>

                <!--This page is used for the Move to another quarter Dialog box -->
                <bean parent="KSAP-PopoverPage" p:id="move_dialog_page" p:headerText="Move to Another Quarter">
                    <property name="instructionalText"
                              value="Which quarter would you like to move [b]@{courseSummaryDetails.code}[/b] to?"/>
                    <property name="items">
                        <list>
                            <ref bean="courseTermsScheduled"/>
                            <ref bean="courseTermSelection"/>
                            <bean parent="KSAP-HorizontalBoxGroup"
                                  p:render="@{planActivities ne null AND planActivities.size() gt 0}">
                                <property name="cssClasses">
                                    <list merge="true">
                                        <value>myplan-status</value>
                                        <value>info</value>
                                    </list>
                                </property>
                                <property name="items">
                                    <list>
                                        <bean parent="MyPlanMessagingIcon"/>
                                        <bean id="move_sections_info" parent="KSAP-SimpleDataField"
                                              p:propertyName="this" p:escapeHtmlInPropertyValue="false">
                                            <property name="propertyEditor" ref="move_planned_sections_formatter"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#move_sections_info').on('PLAN_ITEM_ADDED', function(event, data){
                                                    jQuery(this).parents().find('.myplan-status.info').fadeOut(250);
                                                });"/>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="KSAP-HorizontalBoxGroup" p:id="actionButtonsGroup">
                                <property name="items">
                                    <list>
                                        <bean p:id="movePlannedCourse" parent="Uif-PrimaryActionButton-Small"
                                              p:actionLabel="Move">
                                            <property name="actionScript"
                                                      value="myplanAjaxSubmitPlanItem('@{planItemId}', 'planItemId', 'movePlannedCourse', e,true);"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#movePlannedCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                                    if (data.planItemType === 'planned' || data.planItemType === 'backup') {
                                                        fnDisplayMessage(data.message, data.cssClass, 'actionButtonsGroup', true, false);
                                                    }
                                                }).on('ERROR', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true, 'errorPlaceholder');
                                                });
                                            "/>
                                        </bean>
                                        <bean parent="closePopoverCancel"/>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="errorPlaceholder"/>
                        </list>
                    </property>
                </bean>

                <!--This page is used for the Copy to another quarter Dialog box -->
                <bean parent="KSAP-PopoverPage" p:id="copy_dialog_page" p:headerText="Copy to Another Quarter">
                    <property name="instructionalText"
                              value="Which quarter would you like to copy [b]@{courseSummaryDetails.code}[/b] to?"/>
                    <property name="items">
                        <list>
                            <ref bean="courseTermsScheduled"/>
                            <ref bean="courseTermSelection"/>
                            <bean parent="KSAP-HorizontalBoxGroup"
                                  p:render="@{planActivities ne null AND planActivities.size() gt 0}">
                                <property name="cssClasses">
                                    <list merge="true">
                                        <value>myplan-status</value>
                                        <value>info</value>
                                    </list>
                                </property>
                                <property name="items">
                                    <list>
                                        <bean parent="MyPlanMessagingIcon"/>
                                        <bean id="copy_sections_info" parent="KSAP-SimpleDataField"
                                              p:propertyName="this" p:escapeHtmlInPropertyValue="false">
                                            <property name="propertyEditor" ref="copy_planned_sections_formatter"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#copy_sections_info').on('PLAN_ITEM_ADDED', function(event, data){
                                                    jQuery(this).parents().find('.myplan-status.info').fadeOut(250);
                                                });"/>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="KSAP-HorizontalBoxGroup" p:id="actionButtonsGroup">
                                <property name="items">
                                    <list>
                                        <bean p:id="copyPlannedCourse"
                                              parent="Uif-PrimaryActionButton-Small"
                                              p:render="@{setToPlanning}"
                                              p:actionLabel="Copy">
                                            <property name="actionScript"
                                                      value="myplanAjaxSubmitPlanItem('@{planItemId}', 'planItemId', 'copyPlannedCourse', e, true);"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#copyPlannedCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                                    if (data.planItemType === 'planned' || data.planItemType === 'backup') {
                                                        fnDisplayMessage(data.message, data.cssClass, 'actionButtonsGroup', true, false);
                                                    }
                                                }).on('ERROR', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true, 'errorPlaceholder');
                                                });
                                            "/>
                                        </bean>
                                        <bean p:id="copyPastPlannedCourse"
                                              parent="Uif-PrimaryActionButton-Small"
                                              p:render="@{setToPlanning eq false and planItemId ne null}"
                                              p:actionLabel="Copy">
                                            <property name="actionScript"
                                                      value="myplanAjaxSubmitPlanItem('@{planItemId}', 'planItemId', 'copyPlannedCourse', e, true);"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#copyPastPlannedCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                                    if (data.planItemType === 'planned' || data.planItemType === 'backup') {
                                                        fnDisplayMessage(data.message, data.cssClass, 'actionButtonsGroup', true, false);
                                                    }
                                                }).on('ERROR', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true, 'errorPlaceholder');
                                                });
                                            "/>
                                        </bean>
                                        <bean p:id="copyAcademicCourse"
                                              parent="Uif-PrimaryActionButton-Small"
                                              p:render="@{setToPlanning eq false and planItemId eq null}"
                                              p:actionLabel="Copy">
                                            <property name="actionScript"
                                                      value="myplanAjaxSubmitPlanItem('@{courseId}', 'courseId', 'addPlannedCourse', e, true);"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#copyAcademicCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                                    if (data.planItemType === 'planned' || data.planItemType === 'backup') {
                                                        fnDisplayMessage(data.message, data.cssClass, 'actionButtonsGroup', true, false);
                                                    }
                                                }).on('ERROR', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true, 'errorPlaceholder');
                                                });
                                            "/>
                                        </bean>
                                        <bean parent="closePopoverCancel"/>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="errorPlaceholder"/>
                        </list>
                    </property>
                </bean>

                <!--This page is used for the Delete plan Item Dialog box -->
                <bean parent="KSAP-PopoverPage" p:id="plan_item_delete_page"
                      p:headerText="Delete @{courseSummaryDetails.code} @{atpId eq null ? 'Bookmark' : 'from the '+shortTerm+' Plan'}">
                    <property name="instructionalText"
                              value="Are you sure that you want to delete [b]@{courseSummaryDetails.code}[/b]? Once deleted, you cannot undo."/>
                    <property name="items">
                        <list>
                            <bean parent="KSAP-HorizontalBoxGroup"
                                  p:render="@{planActivities ne null AND planActivities.size() gt 0}">
                                <property name="cssClasses">
                                    <list merge="true">
                                        <value>myplan-status</value>
                                        <value>info</value>
                                    </list>
                                </property>
                                <property name="items">
                                    <list>
                                        <bean parent="MyPlanMessagingIcon"/>
                                        <bean id="delete_sections_info" parent="KSAP-SimpleDataField"
                                              p:propertyName="this" p:escapeHtmlInPropertyValue="false">
                                            <property name="propertyEditor" ref="delete_planned_sections_formatter"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#delete_sections_info').on('PLAN_ITEM_DELETED', function(event, data){
                                                    jQuery(this).parents().find('.myplan-status.info').fadeOut(250);
                                                });"/>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="KSAP-SimpleInputField" p:propertyName="atpId">
                                <property name="control">
                                    <bean parent="Uif-HiddenControl"/>
                                </property>
                            </bean>
                            <bean parent="KSAP-HorizontalBoxGroup">
                                <property name="items">
                                    <list>
                                        <bean p:id="deletePlannedCourse" parent="Uif-PrimaryActionButton-Small"
                                              p:actionLabel="Delete">
                                            <property name="actionScript"
                                                      value="myplanAjaxSubmitPlanItem('@{planItemId}', 'planItemId', 'removeItem', e);"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#deletePlannedCourse').on('PLAN_ITEM_DELETED', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'deletePlannedCourse', true, true);
                                                }).on('ERROR', function(event, data) {
                                                    fnDisplayMessage(data.message, data.cssClass, 'deletePlannedCourse', true, true);
                                                });
                                            "/>
                                        </bean>
                                        <bean parent="closePopoverCancel"/>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>

                <!-- This page is for adding courses, course placeholder, or a general placeholder -->
                <bean parent="KSAP-PopoverPage" p:id="plan_item_add_page"
                      p:headerText="Add course or placeholder to @{#form.termName}" p:width="350px">
                    <property name="instructionalText"
                              value="What would you like to add to your @{#form.termName}?"/>
                    <property name="items">
                        <list>
                            <bean parent="KSAP-VerticalBoxGroup">
                                <property name="cssClasses">
                                    <list merge="true">
                                        <value>myplan-remove-margin</value>
                                    </list>
                                </property>
                                <property name="items">
                                    <list>
                                        <!--TODO: https://jira.kuali.org/browse/KULRICE-9846 disabled expressions are evaluated before the defaultValue is set, workaround is to set the value on the backend -->
                                        <bean parent="Uif-InputField" p:propertyName="type" p:defaultValue="course">
                                            <property name="control">
                                                <bean parent="Uif-VerticalRadioControl">
                                                    <property name="options">
                                                        <list>
                                                            <bean parent="Uif-KeyLabelPair" p:key="course"
                                                                  p:value="Course or course placeholder [css='ksap-text-gray fl-font-size-90'](e.g. ENGL 3xx)[/css]"/>
                                                        </list>
                                                    </property>
                                                </bean>
                                            </property>
                                        </bean>
                                        <bean parent="KSAP-HorizontalBoxGroup" p:style="margin-left:2em;"
                                              p:progressiveRender="#form.type EQ 'course'">
                                            <property name="items">
                                                <list>
                                                    <bean parent="Uif-InputField" p:propertyName="courseCd"
                                                          p:id="courseCode" p:width="70%">
                                                        <property name="control">
                                                            <bean parent="Uif-TextControl" p:style="width:180px;">
                                                                <property name="onDocumentReadyScript"
                                                                          value="jQuery('#courseCd').focus();"/>
                                                                <property name="watermarkText" value="e.g. BIOL 180"/>
                                                                <property name="maxLength" value="11"/>
                                                            </bean>
                                                        </property>
                                                    </bean>
                                                    <bean parent="Uif-InputField" p:propertyName="credit"
                                                          p:id="creditsCourse" p:hidden="true">
                                                        <property name="control">
                                                            <bean parent="dropdownPlaceholderCredits"/>
                                                        </property>
                                                        <property name="onDocumentReadyScript" value="
                                                            jQuery('#courseCode_control').bind('keyup paste cut contextmenu mouseout blur', function(e) {
                                                                var display = ( /([0-9]xx)/i.test( jQuery(this).val() ) ) ? 'block' : 'none';
                                                                jQuery('#creditsCourse').css('display', display);
                                                            });
                                                        "/>
                                                    </bean>
                                                </list>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="KSAP-VerticalBoxGroup">
                                <property name="cssClasses">
                                    <list merge="true">
                                        <value>myplan-remove-margin</value>
                                    </list>
                                </property>
                                <property name="items">
                                    <list>
                                        <bean parent="Uif-InputField" p:propertyName="type" p:defaultValue="course">
                                            <property name="control">
                                                <bean parent="Uif-VerticalRadioControl">
                                                    <property name="options">
                                                        <list>
                                                            <bean parent="Uif-KeyLabelPair" p:key="general"
                                                                  p:value="General placeholder [css='ksap-text-gray fl-font-size-90'](e.g. Elective, VLPA, Other, etc)[/css]"/>
                                                        </list>
                                                    </property>
                                                </bean>
                                            </property>
                                        </bean>
                                        <bean parent="KSAP-HorizontalBoxGroup" p:style="margin-left:2em;"
                                              p:progressiveRender="#form.type EQ 'general'">
                                            <property name="items">
                                                <list>
                                                    <bean parent="KSAP-SimpleInputField" p:propertyName="placeholder"
                                                          p:width="70%">
                                                        <property name="control">
                                                            <bean parent="Uif-DropdownControl" p:style="width:90%;">
                                                                <property name="options">
                                                                    <list>
                                                                        <bean parent="Uif-KeyLabelPair" p:key=""
                                                                              p:value="Select a Placeholder"/>
                                                                        <bean parent="Uif-KeyLabelPair" p:key="elective"
                                                                              p:value="Elective"/>
                                                                        <bean parent="Uif-KeyLabelPair" p:key="c"
                                                                              p:value="C (English Composition)"/>
                                                                        <bean parent="Uif-KeyLabelPair" p:key="w"
                                                                              p:value="W (Additional Writing)"/>
                                                                        <bean parent="Uif-KeyLabelPair" p:key="qsr"
                                                                              p:value="Q/SR (Quantitative and Symbolic Reasoning)"/>
                                                                        <bean parent="Uif-KeyLabelPair" p:key="fl"
                                                                              p:value="FL (Foreign Language)"/>
                                                                        <bean parent="Uif-KeyLabelPair" p:key="vlpa"
                                                                              p:value="VLPA (Visual, Literary, and Performing Arts)"/>
                                                                        <bean parent="Uif-KeyLabelPair" p:key="is"
                                                                              p:value="I&amp;S (Individuals and Societies)"/>
                                                                        <bean parent="Uif-KeyLabelPair" p:key="nw"
                                                                              p:value="NW (Natural World)"/>
                                                                        <bean parent="Uif-KeyLabelPair" p:key="other"
                                                                              p:value="Other (Enter description in 'Note' below)"/>
                                                                    </list>
                                                                </property>
                                                            </bean>
                                                        </property>
                                                    </bean>
                                                    <bean parent="KSAP-SimpleInputField" p:propertyName="credit"
                                                          p:id="creditsGeneral">
                                                        <property name="control">
                                                            <bean parent="dropdownPlaceholderCredits"/>
                                                        </property>
                                                    </bean>
                                                </list>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="KSAP-SimpleInputField" p:propertyName="note"
                                  p:style="margin: 20px 0;">
                                <property name="label" value="Note for course or placeholder"/>
                                <property name="fieldLabel.render" value="true"/>
                                <property name="labelPlacement" value="TOP"/>
                                <property name="control">
                                    <bean parent="Uif-TextControl"
                                          p:watermarkText="Enter a short note (150 characters max)" p:maxLength="150"
                                          p:style="width:90%">
                                        <property name="required" value="@{#form.placeholder EQ 'other'}"/>
                                    </bean>
                                </property>
                            </bean>
                            <bean parent="KSAP-SimpleInputField" p:id="errorPlaceholder" p:propertyName="atpId"
                                  p:hidden="true">
                                <property name="control">
                                    <bean parent="Uif-HiddenControl"/>
                                </property>
                            </bean>
                            <bean parent="KSAP-HorizontalBoxGroup-NoMargin" p:id="actionButtonsGroup">
                                <property name="items">
                                    <list>
                                        <bean id="actionCoursePlaceholder" p:id="actionCoursePlaceholder"
                                              parent="Uif-PrimaryActionButton-Small"
                                              p:actionLabel="Add to Plan">
                                            <!-- TODO: FIX ACTION FUNCTION ==== Dont use quickadd function, being deprecated. Make sure all necessary data is passed to plan controller. -->
                                            <property name="actionScript"
                                                      value="myplanAjaxSubmitPlanItem('quick_add', 'quick_add', 'addPlannedCourse', e, true);
                                                      myplanAjaxSubmitQuickAdd('quick_Add',{ atpId:'@{#form.atpId}',planType:'@{#form.backup ? 'backup' : 'plan'}'},'quickAddCourse',e);"/>
                                            <property name="disabled"
                                                      value="@{#form.type EQ null OR (#form.type EQ 'course' AND #form.courseCd EQ null) OR (#form.type EQ 'general' AND #form.placeholder EQ null) OR (#form.placeholder EQ 'other' AND #form.note EQ null)}"/>
                                            <property name="evaluateDisabledOnKeyUp" value="true"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#actionCoursePlaceholder').on('PLAN_ITEM_ADDED', function(event, data){
                                                    fnCloseAllPopups();
                                                }).on('ERROR', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true,'errorPlaceholder');
                                                });
                                            "/>
                                        </bean>
                                        <bean parent="closePopoverCancel"/>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>

                <!-- This page is for adding courses by course code (Quick Add) (this is temporary until placeholder is implemented) -->
                <bean parent="KSAP-PopoverPage" p:id="quick_add_page"
                      p:headerText="Add a course to @{#form.termName} @{#form.backup ? 'backup' : 'plan'}">
                    <property name="instructionalText"
                              value="Enter the course code [css='ksap-text-gray']e.g. ENGL 220[/css]"/>
                    <property name="items">
                        <list>
                            <bean parent="KSAP-SimpleInputField" p:propertyName="courseCd">
                                <property name="cssClasses">
                                    <list merge="true">
                                        <value>myplan-quick-add-text-box</value>
                                    </list>
                                </property>
                                <property name="control">
                                    <bean parent="Uif-TextControl">
                                        <property name="onDocumentReadyScript"
                                                  value="jQuery('.myplan-quick-add-text-box input').focus();"/>
                                        <property name="onKeyPressScript" value="
                                            var code = (e.keyCode ? e.keyCode : e.which);
                                            if (code == 13) { e.preventDefault(); jQuery('button#quickAddCourse').click(); }
                                        "/>
                                    </bean>
                                </property>
                                <property name="constraintText"
                                          value="Note: The course you selected MAY NOT be offered in your selected quarter. Check back when the Time Schedule is released."/>
                            </bean>
                            <bean parent="KSAP-SimpleInputField" p:propertyName="atpId" p:hidden="true">
                                <property name="control">
                                    <bean parent="Uif-HiddenControl"/>
                                </property>
                            </bean>
                            <bean parent="KSAP-SimpleInputField" p:propertyName="backup" p:hidden="true"
                                  p:defaultValue="@{backup}">
                                <property name="control">
                                    <bean parent="Uif-HiddenControl"/>
                                </property>
                            </bean>
                            <bean parent="KSAP-VerticalBoxGroup" p:id="errorPlaceholder" p:hidden="true"/>
                            <bean parent="KSAP-HorizontalBoxGroup-NoMargin" p:id="actionButtonsGroup">
                                <property name="items">
                                    <list>
                                        <bean id="quickAddCourse" p:id="quickAddCourse"
                                              parent="Uif-PrimaryActionButton-Small" p:actionLabel="Add to Plan">
                                            <property name="actionScript"
                                                      value="myplanAjaxSubmitPlanItem('quick_add', 'quick_add', 'addPlannedCourse', e, true);"/>
                                            <property name="onDocumentReadyScript" value="
                                                jQuery('#quickAddCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                                    fnCloseAllPopups();
                                                }).on('ERROR', function(event, data){
                                                    fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false,true,'errorPlaceholder');
                                                });
                                            "/>
                                        </bean>
                                        <bean parent="closePopoverCancel"/>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <bean id="course_details_info" parent="KSAP-VerticalBoxGroup">
        <property name="cssClasses">
            <list merge="true">
                <value>fl-container-300</value>
            </list>
        </property>
        <property name="items">
            <list>
                <ref bean="course_details_summary_info"/>
            </list>
        </property>
    </bean>
    <!---->

    <bean id="course_details_summary_info" parent="KSAP-VerticalBoxGroup-NoMargin">
        <property name="items">
            <list>
                <!-- List of Scheduled Terms -->
                <ref bean="courseTermsScheduled"/>
                <!-- Last Offered -->
                <bean parent="KSAP-SimpleDataField" p:label="Last Offered"
                      p:propertyName="courseSummaryDetails.lastOffered">
                    <property name="fieldLabel">
                        <bean parent="Uif-Label"/>
                    </property>
                    <property name="fieldLabel.cssClasses" value="fl-font-size-90 fl-text-gray myplan-text-normal"/>
                    <property name="render"
                              value="@{courseSummaryDetails.lastOffered NE null AND courseSummaryDetails.scheduledTerms.size() EQ 0}"/>
                </bean>
                <!-- Projected Terms -->
                <bean parent="KSAP-SimpleDataField" p:label="Projected for"
                      p:propertyName="courseSummaryDetails.termsOffered"
                      p:escapeHtmlInPropertyValue="false">
                    <property name="fieldLabel">
                        <bean parent="Uif-Label"/>
                    </property>
                    <property name="fieldLabel.cssClasses" value="fl-font-size-90 fl-text-gray myplan-text-normal"/>
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-data-list</value>
                        </list>
                    </property>
                    <property name="render"
                              value="@{courseSummaryDetails.termsOffered.size() GT 0}"/>
                </bean>
                <bean parent="KSAP-MessageField" p:label="Projected for">
                    <property name="fieldLabel">
                        <bean parent="Uif-Label"/>
                    </property>
                    <property name="fieldLabel.cssClasses" value="fl-font-size-90 fl-text-gray myplan-text-normal"/>
                    <property name="messageText"
                              value="Check with the department or your adviser for more information about this course."/>
                    <property name="render" value="@{courseSummaryDetails.termsOffered.size() EQ 0}"/>
                </bean>
                <!-- Requisites -->
                <bean parent="Uif-ListDataField" p:label="Course Requisites"
                      p:propertyName="courseSummaryDetails.requisites" p:escapeHtmlInPropertyValue="false">
                    <property name="fieldLabel.cssClasses" value="fl-font-size-90 fl-text-gray myplan-text-normal"/>
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-data-list</value>
                            <value>myplan-multiline-ellipsis</value>
                        </list>
                    </property>
                    <property name="render"
                              value="@{courseSummaryDetails.requisites.size() GT 0}"/>
                </bean>
                <bean parent="KSAP-MessageField" p:label="Course Requisites">
                    <property name="fieldLabel">
                        <bean parent="Uif-Label"/>
                    </property>
                    <property name="fieldLabel.cssClasses" value="fl-font-size-90 fl-text-gray myplan-text-normal"/>
                    <property name="message">
                        <bean parent="Uif-Message" p:messageText="None"/>
                    </property>
                    <property name="render" value="@{courseSummaryDetails.requisites.size() EQ 0}"/>
                </bean>
                <!-- Link to view more details (course details view) -->
                <bean parent="Uif-Link" p:linkText="View more details">
                    <property name="title" value="View more details about @{courseSummaryDetails.code}"/>
                    <property name="href"
                              value="inquiry?methodToCall=start&amp;viewId=CourseDetails-InquiryView&amp;courseId=@{courseSummaryDetails.courseId}"/>
                </bean>
                <bean parent="KSAP-HorizontalBoxGroup">
                    <property name="render" value="@{T(org.kuali.student.myplan.utils.UserSessionHelper).isStudent()}"/>
                    <property name="items">
                        <list>
                            <!-- If not in plan and not in saved courses and not in academic record list -->
                            <bean parent="KSAP-HorizontalBoxGroup"
                                  p:render="@{(plannedCourseSummary.backupList.size() EQ 0 AND plannedCourseSummary.plannedList.size() EQ 0 AND plannedCourseSummary.savedItemId EQ null AND plannedCourseSummary.academicTerms.size() EQ 0)}">
                                <property name="items">
                                    <list>
                                        <ref bean="addToPlanButton"/>
                                        <ref bean="addSavedCourseButton"/>
                                    </list>
                                </property>
                            </bean>
                            <!-- If not in plan and in saved courses and not in academic list-->
                            <bean parent="KSAP-HorizontalBoxGroup"
                                  p:render="@{(plannedCourseSummary.backupList.size() EQ 0 AND plannedCourseSummary.plannedList.size() EQ 0 AND plannedCourseSummary.savedItemId NE null AND plannedCourseSummary.academicTerms.size() EQ 0)}">
                                <property name="items">
                                    <list>
                                        <ref bean="addToPlanButton"/>
                                        <ref bean="removeSavedCourseButton"/>
                                    </list>
                                </property>
                            </bean>
                            <!-- If in plan and in saved courses and not in academic record list -->
                            <bean parent="KSAP-HorizontalBoxGroup"
                                  p:render="@{((plannedCourseSummary.backupList.size() gt 0 or plannedCourseSummary.plannedList.size() gt 0) and plannedCourseSummary.savedItemId ne null and plannedCourseSummary.academicTerms.size() eq 0)}">
                                <property name="items">
                                    <list>
                                        <ref bean="addToPlanButton"/>
                                        <ref bean="removeSavedCourseButton"/>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>
                <bean parent="KSAP-HorizontalBoxGroup-NoMargin"
                      p:render="@{(plannedCourseSummary.backupList.size() GT 0 OR plannedCourseSummary.plannedList.size() GT 0 OR plannedCourseSummary.savedItemId NE null OR plannedCourseSummary.academicTerms.size() GT 0)}">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>myplan-status</value>
                            <value>info</value>
                        </list>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="MyPlanMessagingIcon"/>
                            <bean parent="KSAP-SimpleDataField" p:propertyName="courseAndPlanSummary"
                                  p:escapeHtmlInPropertyValue="false">
                                <property name="propertyEditor" ref="crud_message_matrix_formatter"/>
                                <property name="cssClasses">
                                    <list merge="true">
                                        <value>myplan-data-list</value>
                                        <value>message</value>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <!-- Group for "Add Plan Item" inputs -->
    <bean id="add_planned_course_fields" parent="KSAP-VerticalBoxGroup" p:width="300px" p:hidden="true">
        <property name="instructionalText"
                  value="Which quarter would you like to add [b]@{courseSummaryDetails.code}[/b] to?"/>
        <property name="items">
            <list>
                <ref bean="courseTermsScheduled"/>
                <ref bean="courseTermSelection"/>
                <ref bean="courseMarkAsBackup"/>
                <bean parent="KSAP-HorizontalFieldGroup" p:id="actionButtonsGroup">
                    <property name="items">
                        <list>
                            <bean p:id="addPlannedCourse" parent="Uif-PrimaryActionButton-Small"
                                  p:actionLabel="Add To Plan">
                                <property name="actionScript"
                                          value="myplanAjaxSubmitPlanItem('@{courseSummaryDetails.courseId}', 'courseId', 'addPlannedCourse', e, true);"/>
                                <property name="onDocumentReadyScript" value="
                                    jQuery('#addPlannedCourse').on('PLAN_ITEM_ADDED', function(event, data){
                                        if (data.planItemType === 'planned' || data.planItemType === 'backup') {
                                             fnDisplayMessage(data.message, data.cssClass, 'actionButtonsGroup', true, false);
                                        }
                                    }).on('ERROR', function(event, data){
                                        fnDisplayMessage(data.message, data.cssClass, 'errorPlaceholder', true, false, true, 'errorPlaceholder');
                                    });
                                "/>
                            </bean>
                            <bean p:id="cancelAddPlannedCourse" parent="Uif-SecondaryActionButton-Small"
                                  p:actionLabel="Cancel">
                                <property name="actionScript"
                                          value="fnPopoverSlider('course_details_info', 'course_popover_group', 'right');"/>
                            </bean>
                        </list>
                    </property>
                </bean>
                <bean parent="errorPlaceholder"/>
            </list>
        </property>
    </bean>

    <!-- Delete from courses list confirmation -->
    <bean id="delete_from_list_confirmation" parent="KSAP-VerticalBoxGroup" p:hidden="true" p:width="300px">
        <property name="instructionalText"
                  value="Are you sure that you want to delete [b]@{courseSummaryDetails.code}[/b] from the Bookmarked Courses list? Once deleted, you cannot undo."/>
        <property name="items">
            <list>
                <bean id="hidden_planItemId" parent="KSAP-SimpleInputField" p:propertyName="planItemId"
                      p:defaultValue="@{planItemId}" p:hidden="true">
                    <property name="control">
                        <bean parent="Uif-HiddenControl"/>
                    </property>
                </bean>
                <!-- Container for buttons -->
                <bean parent="KSAP-HorizontalBoxGroup">
                    <property name="items">
                        <list>
                            <bean p:id="deleteCourseYesButton" parent="Uif-PrimaryActionButton-Small"
                                  p:actionLabel="Delete">
                                <property name="actionScript"
                                          value="myplanAjaxSubmitPlanItem('@{courseSummaryDetails.courseId}', 'courseId', 'removeItem', e);"/>
                                <property name="onDocumentReadyScript" value="
                                   jQuery('#deleteCourseYesButton').on('PLAN_ITEM_DELETED', function(event, data) {
                                       fnDisplayMessage(data.message, data.cssClass, 'deleteCourseYesButton', true, true);
                                   }).on('ERROR', function(event, data) {
                                       fnDisplayMessage(data.message, data.cssClass, 'deleteCourseYesButton', true, true);
                                   });"/>
                            </bean>
                            <bean p:id="deleteCourseNoButton" parent="Uif-SecondaryActionButton-Small"
                                  p:actionLabel="Cancel">
                                <property name="actionScript"
                                          value="fnPopoverSlider('course_details_info', 'course_popover_group', 'right');"/>
                            </bean>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <!--****************************Academic Planned Form View**********************-->
    <bean id="StudentAcademicPlanner-FormView" parent="MyPlanBaseFormView">
        <property name="theme">
            <bean parent="MyPlanRetrievedTheme"/>
        </property>
        <property name="onLoadScript" value=""/>
        <property name="id" value="StudentAcademicPlanner-FormView"/>
        <property name="footer.render" value="false"/>
        <property name="header.render" value="false"/>
        <property name="entryPageId" value="student_academic_planner"/>
        <property name="formClass" value="org.kuali.student.myplan.plan.form.PlanForm"/>
        <property name="items">
            <list>
                <bean parent="Uif-Page" p:id="student_academic_planner_page" p:width="150px">
                    <property name="validationMessages">
                        <bean parent="Uif-GroupValidationMessages">
                            <property name="displayMessages" value="true"/>
                            <property name="displayFieldLabelWithMessages" value="false"/>
                        </bean>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="KSAP-VerticalBoxGroup" p:style="border-bottom: dotted 1px #cfcfcf;">
                                <property name="items">
                                    <list>
                                        <bean parent="Uif-Link" p:linkText="Messages (@{messagesCount})">
                                            <property name="href"
                                                      value="lookup?methodToCall=search&amp;viewId=MessagesDetail-LookupView"/>
                                            <property name="render" value="@{messagesCount NE 0}"/>
                                        </bean>
                                        <bean parent="Uif-MessageField" p:messageText="Messages (0)"
                                              p:cssClasses="myplan-text-gray">
                                            <property name="render" value="@{messagesCount EQ 0}"/>
                                        </bean>
                                        <bean parent="Uif-Link" p:linkText="Bookmarked Courses (@{bookmarkedCount})">
                                            <property name="href"
                                                      value="lookup?methodToCall=search&amp;viewId=SavedCoursesDetail-LookupView"/>
                                        </bean>
                                    </list>
                                </property>
                                <property name="propertyReplacers">
                                    <list>
                                        <bean parent="Uif-ConditionalBeanPropertyReplacer" p:propertyName="items"
                                              p:condition="T(org.kuali.student.myplan.utils.UserSessionHelper).isAdviser()">
                                            <property name="replacement">
                                                <list>
                                                    <bean parent="Uif-Message"
                                                          p:messageText="Adviser Access Restricted"/>
                                                </list>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="KSAP-VerticalBoxGroup" p:style="border-bottom: dotted 1px #cfcfcf;">
                                <property name="items">
                                    <list>
                                        <bean parent="Uif-InputField" p:label="MyPlan Settings" p:labelPlacement="TOP"
                                              p:propertyName="enableAdviserView" p:width="auto">
                                            <property name="instructionalMessage">
                                                <bean parent="Uif-Message"
                                                      p:cssClasses="myplan-text-gray fl-font-size-80"
                                                      p:messageText="&quot;Shared&quot; plans are viewable by all UW advisers. &quot;Private&quot; plans are only viewable by you."/>
                                            </property>
                                            <property name="onChangeScript" value="
                                                myplanWriteHiddenToForm('methodToCall', 'planAccess', 'student_academic_planner_page_form');
                                                jQuery('#student_academic_planner_page_form').ajaxSubmit();
                                            "/>
                                            <property name="control">
                                                <bean parent="Uif-VerticalRadioControl">
                                                    <property name="options">
                                                        <list>
                                                            <bean parent="Uif-KeyLabelPair" p:key="true"
                                                                  p:value="Shared"/>
                                                            <bean parent="Uif-KeyLabelPair" p:key="false"
                                                                  p:value="Private"/>
                                                        </list>
                                                    </property>
                                                </bean>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="KSAP-VerticalBoxGroup-NoMargin">
                                <property name="items">
                                    <list>
                                        <bean parent="Uif-Link" p:linkText="Help">
                                            <property name="href"
                                                      value="javascript:openHelpWindow('http://depts.washington.edu/myplan/help-site/');"/>
                                        </bean>
                                        <bean parent="Uif-Link" p:linkText="Log out">
                                            <property name="href"
                                                      value="/@{#ConfigProperties['app.code']}/logout.do"/>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <!--
         Popover Common Components  *************************************************************************************
    -->

    <bean id="courseTitleLink" parent="Uif-Link" p:width="280px" p:style="display:block;">
        <property name="linkText"
                  value="@{courseSummaryDetails.code} @{courseSummaryDetails.courseTitle} (@{courseSummaryDetails.credit})"/>
        <property name="title"
                  value="@{courseSummaryDetails.code.replaceAll(&quot;( )+&quot;, &quot; &quot;)} @{courseSummaryDetails.courseTitle} (@{courseSummaryDetails.credit})"/>
        <property name="href"
                  value="inquiry?methodToCall=start&amp;viewId=CourseDetails-InquiryView&amp;courseId=@{courseSummaryDetails.courseId}"/>
        <property name="cssClasses">
            <list merge="true">
                <value>fl-text-bold</value>
                <value>myplan-text-wrap</value>
            </list>
        </property>
    </bean>

    <!-- Select control for choosing a term -->
    <bean id="courseTermSelection" parent="KSAP-HorizontalFieldGroup"
          p:label="Quarter &amp; Year" p:labelPlacement="TOP">
        <property name="fieldLabel.cssClasses" value="myplan-text-normal"/>
        <property name="items">
            <list>
                <bean parent="KSAP-SimpleInputField" p:propertyName="atpId"
                      p:width="120px">
                    <property name="control">
                        <bean parent="Uif-DropdownControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.myplan.plan.util.TermsListBuilder"/>
                    </property>
                </bean>
                <bean parent="KSAP-Message" p:width="160px"
                      p:messageText="Note: This course MAY NOT be offered in your selected quarter. Check back after the Time Schedule is released.">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>fl-font-size-80</value>
                            <value>fl-text-gray</value>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <!-- List of terms course is scheduled for -->
    <bean id="courseTermsScheduled" parent="KSAP-SimpleDataField" p:label="Scheduled For"
          p:propertyName="courseSummaryDetails">
        <property name="fieldLabel">
            <bean parent="Uif-Label"/>
        </property>
        <property name="fieldLabel.cssClasses" value="fl-text-gray fl-font-size-90 myplan-text-normal"/>
        <property name="escapeHtmlInPropertyValue" value="false"/>
        <property name="propertyEditor" ref="scheduled_terms_list_formatter"/>
        <property name="cssClasses">
            <list merge="true">
                <value>myplan-data-list</value>
            </list>
        </property>
    </bean>

    <!--  Backup checkbox -->
    <bean id="courseMarkAsBackup" parent="KSAP-HorizontalFieldGroup">
        <property name="items">
            <list>
                <bean id="checkbox_backup" parent="KSAP-SimpleInputField" p:propertyName="backup" p:defaultValue="false"
                      p:label="Mark as [b]'Backup'[/b] course. (Optional)"
                      p:labelPlacement="RIGHT">
                    <property name="fieldLabel.render" value="true"/>
                    <property name="fieldLabel.cssClasses" value="myplan-text-normal"/>
                    <property name="control">
                        <bean parent="Uif-CheckboxControl"/>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <!-- Option list of credit values for placeholders -->
    <bean id="dropdownPlaceholderCredits" parent="Uif-DropdownControl">
        <property name="options">
            <list>
                <bean parent="Uif-KeyLabelPair" p:key="" p:value="Credit"/>
                <bean parent="Uif-KeyLabelPair" p:key="1" p:value="1"/>
                <bean parent="Uif-KeyLabelPair" p:key="2" p:value="2"/>
                <bean parent="Uif-KeyLabelPair" p:key="3" p:value="3"/>
                <bean parent="Uif-KeyLabelPair" p:key="4" p:value="4"/>
                <bean parent="Uif-KeyLabelPair" p:key="5" p:value="5"/>
                <bean parent="Uif-KeyLabelPair" p:key="6" p:value="6"/>
                <bean parent="Uif-KeyLabelPair" p:key="7" p:value="7"/>
                <bean parent="Uif-KeyLabelPair" p:key="8" p:value="8"/>
                <bean parent="Uif-KeyLabelPair" p:key="9" p:value="9"/>
                <bean parent="Uif-KeyLabelPair" p:key="10" p:value="10"/>
            </list>
        </property>
    </bean>

    <!-- Placeholder DIV for error messages after submission failure -->
    <bean id="errorPlaceholder" parent="KSAP-SimpleInputField" p:id="errorPlaceholder"
          p:propertyName="courseSummaryDetails.courseId">
        <property name="control">
            <bean parent="Uif-HiddenControl"/>
        </property>
    </bean>

    <!--
         Popover Action Buttons  *************************************************************************************
    -->

    <!--  Add to plan button. Used contextually in course details popup actions -->
    <bean id="addToPlanButton" p:id="addToPlanButton" parent="Uif-PrimaryActionButton-Small" p:actionLabel="Add to Plan"
          p:actionImagePlacement="RIGHT">
        <property name="actionScript"
                  value="fnPopoverSlider('add_planned_course_fields', 'course_popover_group', 'left');"/>
        <property name="actionImage">
            <bean parent="Uif-Image" p:source="@{#ConfigProperties['ks.myplan.externalizable.images.url']}pixel.gif">
                <property name="cssClasses">
                    <list merge="true">
                        <value>rightArrowSmall</value>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <!--  Add to saved courses. Used contextually in course details popup actions -->
    <bean id="addSavedCourseButton" p:id="addSavedCourseButton" parent="Uif-SecondaryActionButton-Small"
          p:actionLabel="Bookmark Course">
        <property name="onDocumentReadyScript" value="
            jQuery('#addSavedCourseButton').on('PLAN_ITEM_ADDED', function(event, data){
                if (data.planItemType === 'wishlist') {
                    fnDisplayMessage(data.message, data.cssClass, 'addSavedCourseButton', true);
                }
            });
        "/>
        <property name="actionScript"
                  value="myplanAjaxSubmitPlanItem('@{courseSummaryDetails.courseId}', 'courseId', 'addSavedCourse', e);"/>
    </bean>

    <!-- Remove from saved courses list button. -->
    <bean id="removeSavedCourseButton" p:id="removeSavedCourseButton" parent="Uif-SecondaryActionButton-Small"
          p:actionLabel="Delete">
        <property name="actionScript"
                  value="fnPopoverSlider('delete_from_list_confirmation','course_popover_group','left');"/>
    </bean>

    <!-- Cancel button to close popover -->
    <bean id="closePopoverCancel" parent="Uif-SecondaryActionButton-Small"
          p:actionLabel="Cancel">
        <property name="actionScript"
                  value="fnCloseAllPopups();"/>
    </bean>

</beans>