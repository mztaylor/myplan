<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">
    <!--
     Copyright 2007-2009 The Kuali Foundation

     Licensed under the Educational Community License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at

     http://www.opensource.org/licenses/ecl2.php

     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License.
    -->

    <bean id="Registration-FormView" parent="Registration-FormView-parent"/>
    <bean abstract="true" id="Registration-FormView-parent" parent="MyPlanBaseFormView">
        <property name="id" value="Registration-FormView"/>
        <property name="persistFormToSession" value="true"/>
        <property name="formClass" value="org.kuali.student.myplan.registration.form.DefaultRegistrationForm"/>
        <property name="width" value="660px"/>
        <property name="items">
            <list>
                <bean id="scheduleView" parent="KSAP-Page">
                    <property name="layoutManager">
                        <bean parent="Uif-VerticalBoxLayout"/>
                    </property>
                    <property name="onDocumentReadyScript" value="parent.jQuery.fancybox.update()"/>
                    <property name="header">
                        <bean parent="KSAP-HeaderTwo"
                              p:headerText="Pinned Schedule @{registrationDetails.getPinnedIndex() + 1}"/>
                    </property>
                    <property name="header.render" value="true"/>
                    <property name="items">
                        <list>
                            <bean parent="scheduleRegisteredItems"/>
                            <bean parent="schedulePlannedItems"/>
                        </list>
                    </property>
                    <property name="footer">
                        <bean id="scheduleViewFooter" parent="KSAP-HorizontalBoxGroup">
                            <property name="cssClasses" value="registrationForm__footer"/>
                            <property name="render"
                                      value="@{!T(org.kuali.student.myplan.plan.util.AtpHelper).getUserSessionHelper().isAdviser()}"/>
                            <property name="items">
                                <list>
                                    <bean parent="KSAP-SecondaryActionButton-Small" p:actionLabel="Unpin this schedule">
                                        <property name="actionScript"
                                                  value="KsapScheduleBuild.confirmRemovedSavedSchedule('@{uniqueId}', true, e)"/>
                                    </bean>
                                    <bean parent="KSAP-PrimaryActionButton-Small" p:actionLabel="Register for Courses" p:navigateToPageId="scheduleSelect"
                                          p:style="float: right;"/>
                                </list>
                            </property>
                        </bean>
                    </property>
                </bean>
                <bean id="scheduleSelect" parent="KSAP-Page">
                    <property name="layoutManager">
                        <bean parent="Uif-VerticalBoxLayout"/>
                    </property>
                    <property name="render"
                              value="@{!T(org.kuali.student.myplan.plan.util.AtpHelper).getUserSessionHelper().isAdviser()}"/>
                    <property name="onDocumentReadyScript" value="parent.jQuery.fancybox.update()"/>
                    <property name="header">
                        <bean parent="KSAP-HeaderTwo" p:headerText="Choose Sections">
                            <property name="upperGroup">
                                <bean parent="KSAP-VerticalBoxGroup">
                                    <property name="items">
                                        <list>
                                            <bean parent="KSAP-Message"
                                                  p:messageText="Register for Courses: [strong]Step 1 of 3[/strong]"/>
                                        </list>
                                    </property>
                                </bean>
                            </property>
                            <property name="lowerGroup">
                                <bean parent="KSAP-VerticalBoxGroup">
                                    <property name="items">
                                        <list>
                                            <bean parent="KSAP-Message"
                                                  p:messageText="Use the buttons below to choose the sections you&#39;d like to submit to the registration system, then click &quot;[strong]Next[/strong].&quot;"/>
                                        </list>
                                    </property>
                                </bean>
                            </property>
                        </bean>
                    </property>
                    <property name="header.render" value="true"/>
                    <property name="instructionalMessage">
                        <bean parent="scheduleRegisterDelayMessage"/>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="scheduleRegisteredItems" p:additionalCssClasses="registrationForm__group--disabled registrationForm__group--indent"/>
                            <bean parent="schedulePlannedItems"/>
                            <bean parent="scheduleRegisterDelayMessage"/>
                        </list>
                    </property>
                    <property name="footer">
                        <bean id="scheduleSelectFooter" parent="KSAP-HorizontalBoxGroup">
                            <property name="cssClasses" value="registrationForm__footer"/>
                            <property name="items">
                                <list>
                                    <bean parent="KSAP-SecondaryActionButton-Small" p:actionLabel="Back" p:navigateToPageId="scheduleView"/>
                                    <bean parent="KSAP-PrimaryActionButton-Small" p:actionLabel="Next" p:methodToCall="registrationDetails"/>
                                </list>
                            </property>
                        </bean>
                    </property>
                </bean>
                <bean id="scheduleConfirm" parent="KSAP-Page">
                    <property name="layoutManager">
                        <bean parent="Uif-VerticalBoxLayout"/>
                    </property>
                    <property name="render"
                              value="@{!T(org.kuali.student.myplan.plan.util.AtpHelper).getUserSessionHelper().isAdviser()}"/>
                    <property name="onDocumentReadyScript" value="parent.jQuery.fancybox.update()"/>
                    <property name="header">
                        <bean parent="KSAP-HeaderTwo" p:headerText="Confirm and Submit">
                            <property name="upperGroup">
                                <bean parent="KSAP-VerticalBoxGroup">
                                    <property name="items">
                                        <list>
                                            <bean parent="KSAP-Message"
                                                  p:messageText="Register for Courses: [strong]Step 2 of 3[/strong]"/>
                                        </list>
                                    </property>
                                </bean>
                            </property>
                            <property name="lowerGroup">
                                <bean parent="KSAP-VerticalBoxGroup">
                                    <property name="items">
                                        <list>
                                            <bean parent="KSAP-Message"
                                                  p:messageText="Verify your selections below, then click the &quot;Send SLNs to Registration&quot; button."/>
                                        </list>
                                    </property>
                                </bean>
                            </property>
                        </bean>
                    </property>
                    <property name="header.render" value="true"/>
                    <property name="instructionalMessage">
                        <bean parent="scheduleRegisterDelayMessage"/>
                    </property>
                    <property name="items">
                        <list>
                            <bean parent="scheduleRegisteredItems" p:additionalCssClasses="registrationForm__group--disabled"/>
                            <bean parent="schedulePlannedItems"/>
                            <bean parent="scheduleRegisterDelayMessage"/>
                        </list>
                    </property>
                    <property name="footer">
                        <bean id="scheduleConfirmFooter" parent="KSAP-HorizontalBoxGroup">
                            <property name="cssClasses" value="registrationForm__footer"/>
                            <property name="items">
                                <list>
                                    <bean parent="KSAP-SecondaryActionButton-Small" p:actionLabel="Back" p:navigateToPageId="scheduleSelect"/>
                                    <bean parent="Uif-Link" p:id="sendToRegistration">
                                        <property name="render" value="@{registrationDetails.registrationUrl NE null}"/>
                                        <property name="linkText" value="Send SLNs to Registration"/>
                                        <property name="title" value="Send SLNs to Registration"/>
                                        <property name="href"
                                                  value="@{registrationDetails.registrationUrl}"/>
                                        <property name="cssClasses"
                                                  value="btn btn-primary btn-small"/>
                                        <property name="style" value="float: right;"/>
                                        <property name="target" value="_blank"/>
                                        <property name="onClickScript" value="actionInvokeHandler(this)"/>
                                        <property name="dataAttributes">
                                            <map>
                                                <entry key="ajaxsubmit" value="true"/>
                                                <entry key="validate" value="false"/>
                                                <entry key="submit_data" value="{&quot;methodToCall&quot;:&quot;navigate&quot;,&quot;actionParameters[navigateToPageId]&quot;:&quot;scheduleCompleted&quot;,&quot;focusId&quot;:&quot;sendToRegistration&quot;,&quot;jumpToId&quot;:&quot;sendToRegistration&quot;}"/>
                                            </map>
                                        </property>
                                    </bean>
                                </list>
                            </property>
                        </bean>
                    </property>
                </bean>
                <bean id="scheduleCompleted" parent="KSAP-Page">
                    <property name="layoutManager">
                        <bean parent="Uif-VerticalBoxLayout"/>
                    </property>
                    <property name="render"
                              value="@{!T(org.kuali.student.myplan.plan.util.AtpHelper).getUserSessionHelper().isAdviser()}"/>
                    <property name="onDocumentReadyScript" value="parent.jQuery.fancybox.update()"/>
                    <property name="header">
                        <bean parent="KSAP-HeaderTwo" p:headerText="Confirm and Submit">
                            <property name="upperGroup">
                                <bean parent="KSAP-VerticalBoxGroup">
                                    <property name="items">
                                        <list>
                                            <bean parent="KSAP-Message"
                                                  p:messageText="Register for Courses: [strong]Step 3 of 3[/strong]"/>
                                        </list>
                                    </property>
                                </bean>
                            </property>
                        </bean>
                    </property>
                    <property name="header.render" value="true"/>
                    <property name="items">
                        <list>
                            <bean parent="KSAP-SuccessMessage">
                                <property name="items">
                                    <list>
                                        <bean parent="KSAP-NoSpanMessage" p:messageText="Sent successfully."/>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="KSAP-Message" p:cssClasses="block" p:messageText="A response from the registration system will open in a new browser window shortly. If your SLN submission was accepted, you'll see your updated schedule on MyPlan within a few minutes."/>
                        </list>
                    </property>
                    <property name="footer">
                        <bean parent="KSAP-HorizontalBoxGroup" p:cssClasses="uif-boxLayoutVerticalItem">
                            <property name="items">
                                <list>
                                    <bean parent="Uif-Link">
                                        <property name="linkText" value="Go to Plan Details"/>
                                        <property name="title" value="Go to Plan Details"/>
                                        <property name="href" value="inquiry?methodToCall=start&amp;viewId=SingleTerm-InquiryView&amp;term_atp_id=@{termId}"/>
                                        <property name="target" value="_parent"/>
                                        <property name="cssClasses" value="btn btn-primary btn-small"/>
                                    </bean>
                                </list>
                            </property>
                        </bean>
                    </property>
                </bean>
            </list>
        </property>
        <property name="header.render" value="false"/>
        <property name="footer.render" value="false"/>
    </bean>

    <bean id="scheduleRegisterDelayMessage" parent="KSAP-Message" p:cssClasses="registrationForm__note"
          p:messageText="[strong]Note[/strong]: Open/closed status is delayed by 1-2 minutes."/>

    <bean id="scheduleCurrentRegisteredItemHeader" parent="KSAP-VerticalBoxGroup">
        <property name="items">
            <list>
                <bean parent="KSAP-NoSpanMessage" p:messageText="[0] Registered">
                    <property name="inlineComponents">
                        <list>
                            <bean parent="Uif-Image"
                                  p:source="@{#ConfigProperties['ks.myplan.externalizable.images.url']}/sb/icon_lock.png"/>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <bean id="scheduleRegistrationItem" parent="KSAP-MessageField" p:cssClasses="registrationForm__courseTitle"
          p:messageText="@{#line.courseCode} @{#line.courseTitle}"/>

    <bean id="scheduleRegistrationItemLink" parent="Uif-LinkField" p:cssClasses="registrationForm__courseTitle"
          p:linkText="@{#line.courseCode} @{#line.courseTitle} (@{#line.credits})">
        <property name="href"
                  value="inquiry?methodToCall=start&amp;viewId=CourseDetails-InquiryView&amp;courseId=@{#line.courseId}&amp;courseCd=@{#line.courseCode}"/>
    </bean>

    <bean id="schedulePlannedItems" parent="KSAP-StackedCollectionGroup">
        <property name="cssClasses" value="registrationForm__group"/>
        <property name="collectionObjectClass" value="org.kuali.student.myplan.schedulebuilder.dto.CourseOptionInfo"/>
        <property name="propertyName" value="registrationDetails.plannedCourses"/>
        <property name="render" value="@{registrationDetails.plannedCourses.size() GT 0}"/>
        <property name="layoutManager.lineGroupPrototype.cssClasses" value="registrationForm__course"/>
        <property name="items">
            <list>
                <bean parent="scheduleRegistrationItemLink"/>
                <bean parent="KSAP-MessageField" p:messageText="@{#line.possibleErrors.getErrorMessage()}"
                      p:render="@{#line.possibleErrors NE null AND #line.possibleErrors.getErrorType() NE null}">
                    <property name="cssClasses"
                              value="alert alert-@{#line.possibleErrors NE null ? #line.possibleErrors.getErrorType() : 'no-error'}"/>
                </bean>
            </list>
        </property>
        <property name="subCollections">
            <list>
                <bean parent="scheduleRegistrationItemActivities"/>
            </list>
        </property>
        <property name="propertyReplacers">
            <list>
                <bean parent="Uif-ConditionalBeanPropertyReplacer" p:propertyName="items"
                      p:condition="pageId NE 'scheduleView'">
                    <property name="replacement">
                        <list>
                            <bean parent="scheduleRegistrationItem"/>
                        </list>
                    </property>
                </bean>
                <bean parent="Uif-ConditionalBeanPropertyReplacer" p:propertyName="subCollections"
                      p:condition="pageId EQ 'scheduleSelect'">
                    <property name="replacement">
                        <list>
                            <bean parent="scheduleRegistrationItemActivitySelect"/>
                        </list>
                    </property>
                </bean>
                <bean parent="Uif-ConditionalBeanPropertyReplacer" p:propertyName="subCollections"
                      p:condition="pageId EQ 'scheduleConfirm'">
                    <property name="replacement">
                        <list>
                            <bean parent="scheduleRegistrationItemActivities_confirm"/>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <bean id="scheduleRegisteredItems" parent="schedulePlannedItems">
        <property name="propertyName" value="registrationDetails.registeredCourses"/>
        <property name="render" value="@{registrationDetails.registeredCourses.size() GT 0}"/>
        <property name="layoutManager.lineGroupPrototype.header">
            <bean parent="KSAP-HeaderDiv" p:hidden="true">
                <property name="upperGroup">
                    <bean parent="scheduleCurrentRegisteredItemHeader"/>
                </property>
            </bean>
        </property>
        <property name="subCollections">
            <list>
                <bean parent="scheduleRegistrationItemActivitiesRegistered"/>
            </list>
        </property>
        <property name="propertyReplacers">
            <list>
                <bean parent="Uif-ConditionalBeanPropertyReplacer" p:propertyName="items"
                      p:condition="pageId NE 'scheduleView'">
                    <property name="replacement">
                        <list>
                            <bean parent="scheduleRegistrationItem"/>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

   <!-- <bean id="scheduleRegistrationItemActivities" parent="KSAP-TableCollectionGroup">
        <property name="propertyName" value="combinedActivities"/>
        <property name="bindingInfo.bindToForm" value="true"/>
        <property name="readOnly" value="true"/>
        <property name="collectionObjectClass"
                  value="org.kuali.student.myplan.schedulebuilder.dto.ActivityOptionInfo"/>
        <property name="layoutManager.numberOfColumns" value="@{pageId NE 'scheduleView' ? 10 : 9}"/>
        <property name="cssClasses" value="registrationActivity__data"/>
        <property name="items">
            <list>
                <bean parent="scheduleRegistrationActivityCode"/>
                <bean parent="scheduleRegistrationActivityCredits"/>
                <bean parent="scheduleRegistrationActivityMeetingDays"/>
                <bean parent="scheduleRegistrationActivityMeetingTime"/>
                <bean parent="scheduleRegistrationActivityMeetingLocation"/>
                <bean parent="scheduleRegistrationActivityRegCode"/>
                <bean parent="scheduleRegistrationActivityInstituteCode"/>
                <bean parent="scheduleRegistrationActivityEnrollRestriction"/>
                <bean parent="scheduleRegistrationActivityEnrollment"/>
                <bean parent="scheduleRegistrationActivityEnrollStatus"/>
            </list>
        </property>
    </bean>-->

    <bean id="scheduleRegistrationItemActivities" parent="KSAP-StackedCollectionGroup">
        <property name="collectionObjectClass"
                  value="org.kuali.student.myplan.schedulebuilder.dto.ActivityOptionInfo"/>
        <property name="propertyName" value="combinedActivities"/>
        <property name="bindingInfo.bindToForm" value="true"/>
        <property name="readOnly" value="true"/>
        <property name="cssClasses" value="registrationActivity__data"/>
        <property name="items">
            <list>
                <bean parent="scheduleRegistrationActivityCode"/>
                <bean parent="scheduleRegistrationActivityCredits"/>
                <bean parent="scheduleRegistrationActivityMeetingDays"/>
                <bean parent="scheduleRegistrationActivityMeetingTime"/>
                <bean parent="scheduleRegistrationActivityMeetingLocation"/>
                <bean parent="scheduleRegistrationActivityRegCode"/>
                <bean parent="scheduleRegistrationActivityInstituteCode"/>
                <bean parent="scheduleRegistrationActivityEnrollRestriction"/>
                <bean parent="scheduleRegistrationActivityEnrollment"/>
                <bean parent="scheduleRegistrationActivityEnrollStatus"/>
            </list>
        </property>
    </bean>

    <bean id="scheduleRegistrationItemActivities_confirm" parent="scheduleRegistrationItemActivities">
        <property name="layoutManager.lineGroupPrototype.render" value="@{getSelectedRegistrationCodes().contains(#line.registrationCode)}"/>
    </bean>

    <bean id="scheduleRegistrationItemActivitiesRegistered" parent="KSAP-TableCollectionGroup">
        <property name="propertyName" value="combinedActivities"/>
        <property name="bindingInfo.bindToForm" value="true"/>
        <property name="readOnly" value="true"/>
        <property name="collectionObjectClass"
                  value="org.kuali.student.myplan.schedulebuilder.dto.ActivityOptionInfo"/>
        <property name="layoutManager.numberOfColumns" value="@{pageId NE 'scheduleView' ? 5 : 4}"/>
        <property name="cssClasses" value="registrationActivity__data"/>
        <property name="items">
            <list>
                <bean parent="scheduleRegistrationActivityCode"/>
                <bean parent="Uif-SpaceField" p:render="@{pageId NE 'scheduleView'}" p:width="36px"/>
                <bean parent="scheduleRegistrationActivityMeetingDays"/>
                <bean parent="scheduleRegistrationActivityMeetingTime"/>
                <bean parent="scheduleRegistrationActivityMeetingLocation"/>
            </list>
        </property>
    </bean>

    <!--For second and third pages-->

    <bean id="scheduleRegistrationItemActivitySelect" parent="KSAP-StackedCollectionGroup">
        <property name="collectionObjectClass"
                  value="org.kuali.student.myplan.schedulebuilder.dto.ActivityOptionInfo"/>
        <property name="propertyName" value="activityOptions"/>
        <property name="bindingInfo.bindToForm" value="true"/>
        <property name="readOnly" value="false"/>
        <property name="items">
            <list>
                <bean parent="Uif-InputField" p:propertyName="selectedForReg">
                    <property name="cssClasses" value="registrationActivity__data"/>
                    <property name="control">
                        <bean parent="Uif-VerticalRadioControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.myplan.schedulebuilder.util.RegistrationKeyValueFinder"/>
                    </property>
                </bean>
            </list>
        </property>
        <property name="subCollections">
            <list>
                <bean parent="plannedSecondaryActivityCollection"/>
            </list>
        </property>
    </bean>

    <bean id="plannedSecondaryActivityCollection" parent="KSAP-StackedCollectionGroup">
        <property name="collectionObjectClass"
                  value="org.kuali.student.myplan.schedulebuilder.dto.SecondaryActivityOptionsInfo"/>
        <property name="propertyName" value="secondaryOptions"/>
        <property name="bindingInfo.bindToForm" value="true"/>
        <property name="readOnly" value="false"/>
        <property name="subCollections">
            <list>
                <bean parent="scheduleRegistrationItemActivitySelectSecondary"/>
            </list>
        </property>
    </bean>

    <bean id="scheduleRegistrationItemActivitySelectSecondary" parent="KSAP-StackedCollectionGroup">
        <property name="collectionObjectClass"
                  value="org.kuali.student.myplan.schedulebuilder.dto.ActivityOptionInfo"/>
        <property name="propertyName" value="activityOptions"/>
        <property name="bindingInfo.bindToForm" value="true"/>
        <property name="readOnly" value="false"/>
        <property name="items">
            <list>
                <bean parent="Uif-InputField" p:propertyName="selectedForReg">
                    <property name="cssClasses" value="registrationActivity__data"/>
                    <property name="control">
                        <bean parent="Uif-VerticalRadioControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.myplan.schedulebuilder.util.RegistrationKeyValueFinder"/>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <bean id="scheduleRegistrationActivityCode" parent="KSAP-MessageField" p:messageText="@{#line.activityCode}"
          p:width="24px" p:cssClasses="registrationActivity__code @{#form.getPlannedItems().containsKey(#line.activityOfferingId) ? 'registrationActivity__sectionCd--planned':''}"/>

    <bean id="scheduleRegistrationActivityCredits" parent="KSAP-MessageField" p:messageText="@{#line.primary EQ true ? '(' + #line.courseCredit + ')' : ''}" p:width="36px" p:cssClasses="registrationActivity__credits"
          p:render="@{pageId NE 'scheduleView'}"/>

    <bean id="scheduleRegistrationActivityMeetingDays" parent="KSAP-MessageField" p:messageText="@{#line.meetingDays}" p:width="72px" p:cssClasses="registrationActivity__meetingDays"/>

    <bean id="scheduleRegistrationActivityMeetingTime" parent="KSAP-MessageField" p:messageText="@{!#line.tbd ? #line.meetingTimes : 'To be arranged'}" p:width="124px" p:cssClasses="registrationActivity__meetingTime"/>

    <bean id="scheduleRegistrationActivityMeetingLocation" parent="KSAP-MessageField" p:messageText="@{#line.meetingLocation}"  p:width="72px" p:cssClasses="registrationActivity__meetingLocation"/>

    <bean id="scheduleRegistrationActivityRegCode" parent="Uif-LinkField" p:linkText="@{#line.registrationCode}" p:href="@{#ConfigProperties['ks.myplan.externalizable.sln.url']}@{T(org.kuali.student.myplan.plan.util.AtpHelper).atpIdToQtrYrParam(#form.termId)}&amp;SLN=@{#line.registrationCode}" p:cssClasses="registrationActivity__regCode"
          p:width="48px" p:target="_blank"/>

    <bean id="scheduleRegistrationActivityInstituteCode" parent="KSAP-MessageField" p:cssClasses="registrationActivity__instituteCode registrationActivity__instituteCode--@{#line.instituteName NE '' ? 'show':'hide'}"
          p:messageText="@{#line.instituteName}" p:width="24px"/>

    <bean id="scheduleRegistrationActivityEnrollRestriction" parent="Uif-ImageField" p:width="16px">
        <property name="cssClasses" value="registrationActivity__enrollRest registrationActivity__enrollRest--@{#line.enrollmentRestriction}"/>
        <property name="source" value="@{#ConfigProperties['ks.myplan.externalizable.images.url']}/pixel.gif"/>
    </bean>

    <bean id="scheduleRegistrationActivityEnrollment" parent="KSAP-MessageField" p:cssClasses="registrationActivity__enrollState"
          p:messageText="[strong]@{#line.filledSeats}[/strong] / @{#line.totalSeats}" p:width="48px"/>

    <bean id="scheduleRegistrationActivityEnrollStatus" parent="KSAP-MessageField" p:messageText="@{#line.enrollStatus}"
          p:width="48px" p:cssClasses="registrationActivity__enrollStatus registrationActivity__enrollStatus--@{#line.enrollStatus.toLowerCase()}"/>

</beans>
